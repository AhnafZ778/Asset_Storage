<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Liquid-Toon-Nav | Elastic UI</title>

    <!-- DEPENDENCIES -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script
      src="https://unpkg.com/react@18/umd/react.production.min.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/framer-motion@11.0.8/dist/framer-motion.js"
      crossorigin
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script
      src="https://unpkg.com/lucide@0.263.0/dist/umd/lucide.min.js"
      crossorigin
    ></script>

    <!-- CSS: TOON STYLES -->
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800;900&display=swap");

      :root {
        --toon-black: #111111;
        --toon-shadow: 6px 6px 0px rgba(0, 0, 0, 1);
        --toon-shadow-sm: 4px 4px 0px rgba(0, 0, 0, 1);
      }

      * {
        font-family: "Nunito", sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      body {
        min-height: 100vh;
        overflow-x: hidden;
        background: #fffbeb; /* Yellow-50 warm tint */
      }

      /* Crisp Dotted Pattern Background */
      .toon-bg {
        background-color: #fff7d6;
        background-image: radial-gradient(#111 1px, transparent 1px);
        background-size: 24px 24px;
        background-position: 0 0;
        opacity: 1;
      }

      /* Helper for hard shadows */
      .hard-shadow {
        box-shadow: var(--toon-shadow);
      }
      .hard-shadow-sm {
        box-shadow: var(--toon-shadow-sm);
      }

      /* Reduce motion preference */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          transition-duration: 0.01ms !important;
          scroll-behavior: auto !important;
        }
      }
    </style>
  </head>

  <body class="toon-bg">
    <!-- HTML: APP ROOT -->
    <div id="root"></div>

    <!-- JS: REACT APPLICATION -->
    <script type="text/babel">
      const { useEffect, useMemo, useRef, useState, useCallback } = React;
      const { motion, AnimatePresence, LayoutGroup } = Motion;

      /* 
       ================================================================
       1. CONFIGURATION (Physics & Data)
       ================================================================
    */

      // Physics: "The Butter Spring"
      // Lower stiffness + higher damping + mass = Heavy, Smooth, "Liquid" feel.
      const smoothToonSpring = {
        type: "spring",
        stiffness: 280,
        damping: 24,
        mass: 1.1,
      };

      /* 
       ================================================================
       2. ASSETS (Icons)
       ================================================================
    */
      const IconBase = ({ children }) => (
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="3"
          strokeLinecap="round"
          strokeLinejoin="round"
        >
          {children}
        </svg>
      );

      const Icons = {
        Home: () => (
          <IconBase>
            <path d="M3 10.5l9-7 9 7" />
            <path d="M5 9.5V20a2 2 0 0 0 2 2h3v-7h4v7h3a2 2 0 0 0 2-2V9.5" />
          </IconBase>
        ),
        Briefcase: () => (
          <IconBase>
            <rect x="7" y="7" width="10" height="12" rx="2" />
            <path d="M9 7V6a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v1" />
            <path d="M7 12h10" />
          </IconBase>
        ),
        Sparkles: () => (
          <IconBase>
            <path d="M12 2l1.2 4.1L17.3 7.3 13.2 8.5 12 12.6 10.8 8.5 6.7 7.3l4.1-1.2L12 2z" />
            <path d="M19 12l.8 2.6 2.6.8-2.6.8L19 19l-.8-2.6-2.6-.8 2.6-.8L19 12z" />
            <path d="M5 12l.8 2.6 2.6.8-2.6.8L5 19l-.8-2.6-2.6-.8 2.6-.8L5 12z" />
          </IconBase>
        ),
        Mail: () => (
          <IconBase>
            <rect x="3" y="5" width="18" height="14" rx="2" />
            <path d="M3 7l9 6 9-6" />
          </IconBase>
        ),
      };

      /* 
       ================================================================
       3. COMPONENTS
       ================================================================
    */

      // --- SUB-COMPONENT: Individual Link Item ---
      function LiquidToonItem({
        item,
        isExpanded,
        isActive,
        isHovered,
        onHover,
        onSelect,
      }) {
        const Icon = Icons[item.icon];

        return (
          <motion.button
            layout // participates in the flex layout
            className="relative flex items-center justify-center outline-none select-none z-10"
            style={{
              height: 48,
              WebkitTapHighlightColor: "transparent",
            }}
            onMouseEnter={() => onHover(item.id)}
            onFocus={() => onHover(item.id)}
            onMouseLeave={() => onHover(null)}
            onBlur={() => onHover(null)}
            onClick={() => onSelect(item.id)}
            // Gentle tactile press (squash)
            whileTap={{ scale: 0.92 }}
            transition={smoothToonSpring}
          >
            {/* Active Blob Background */}
            {isActive && (
              <motion.div
                layoutId="activeBlob"
                className="absolute inset-0 rounded-full border-2 border-black bg-white"
                style={{
                  backgroundColor: item.color,
                  boxShadow: "4px 4px 0 rgba(0,0,0,1)", // Hard shadow inside relative to button
                }}
                initial={{ scaleX: 0.9, scaleY: 0.9 }}
                animate={{ scaleX: 1, scaleY: 1 }}
                transition={smoothToonSpring}
              />
            )}

            <div className="relative flex items-center px-4 z-20 gap-2">
              {/* Icon: Jumps up slightly on active/hover */}
              <motion.span
                layout="position"
                className="flex items-center justify-center text-[#111]"
                animate={{
                  y: isHovered || isActive ? -4 : 0,
                }}
                transition={smoothToonSpring}
              >
                <Icon />
              </motion.span>

              {/* Label: Reveal on expansion */}
              <AnimatePresence mode="popLayout">
                {isExpanded && (
                  <motion.span
                    layout="position"
                    className="whitespace-nowrap font-black text-lg tracking-tight text-[#111]"
                    initial={{ opacity: 0, x: -8, filter: "blur(4px)" }}
                    animate={{
                      opacity: 1,
                      x: 0,
                      filter: "blur(0px)",
                      transition: { ...smoothToonSpring, delay: 0.05 },
                    }}
                    exit={{
                      opacity: 0,
                      x: -8,
                      filter: "blur(4px)",
                      transition: { duration: 0.15 },
                    }}
                  >
                    {item.label}
                  </motion.span>
                )}
              </AnimatePresence>
            </div>
          </motion.button>
        );
      }

      // --- MAIN COMPONENT: The Navbar ---
      function LiquidToonIsland() {
        // Configuration
        const items = useMemo(
          () => [
            { id: "home", label: "Home", icon: "Home", color: "#FACC15" }, // yellow-400
            { id: "work", label: "Work", icon: "Briefcase", color: "#60A5FA" }, // blue-400
            { id: "about", label: "About", icon: "Sparkles", color: "#F472B6" }, // pink-400
            { id: "contact", label: "Contact", icon: "Mail", color: "#4ADE80" }, // green-400
          ],
          []
        );

        const [activeId, setActiveId] = useState("home");
        const [hoveredId, setHoveredId] = useState(null);
        const [isExpanded, setIsExpanded] = useState(false);

        // Refs for hover timing
        const hoverCapableRef = useRef(true);
        const enterTimer = useRef(null);
        const leaveTimer = useRef(null);

        useEffect(() => {
          try {
            hoverCapableRef.current =
              window.matchMedia("(hover: hover)").matches;
          } catch (_) {
            hoverCapableRef.current = true;
          }
        }, []);

        const handleEnter = useCallback(() => {
          if (!hoverCapableRef.current) return;
          if (leaveTimer.current) clearTimeout(leaveTimer.current);
          enterTimer.current = setTimeout(() => setIsExpanded(true), 50);
        }, []);

        const handleLeave = useCallback(() => {
          if (!hoverCapableRef.current) return;
          if (enterTimer.current) clearTimeout(enterTimer.current);
          leaveTimer.current = setTimeout(() => {
            setIsExpanded(false);
            setHoveredId(null);
          }, 200);
        }, []);

        return (
          <LayoutGroup>
            {/* Flex-Anchor Wrapper for Center-Out Expansion */}
            <div className="fixed top-8 inset-x-0 flex justify-center z-50 pointer-events-none">
              <motion.nav
                layout
                onMouseEnter={handleEnter}
                onMouseLeave={handleLeave}
                className="pointer-events-auto relative bg-white rounded-full border-2 border-black hard-shadow px-2 flex items-center gap-1"
                style={{
                  height: 68,
                  willChange: "transform, width",
                }}
                transition={smoothToonSpring}
                role="navigation"
              >
                {items.map((item) => (
                  <LiquidToonItem
                    key={item.id}
                    item={item}
                    isExpanded={isExpanded}
                    isActive={activeId === item.id}
                    isHovered={hoveredId === item.id}
                    onHover={setHoveredId}
                    onSelect={setActiveId}
                  />
                ))}
              </motion.nav>
            </div>
          </LayoutGroup>
        );
      }

      // --- DEMO CONTENT (For Preview Only) ---
      function Sticker({ color, rotate, children }) {
        return (
          <div
            className={`inline-flex items-center justify-center px-4 py-2 bg-white border-2 border-black hard-shadow-sm rounded-lg font-bold text-sm transform ${rotate}`}
          >
            <div
              className={`w-3 h-3 rounded-full border-2 border-black mr-2`}
              style={{ background: color }}
            ></div>
            {children}
          </div>
        );
      }

      function PageContent() {
        return (
          <main className="min-h-screen pt-40 px-6 pb-20 flex flex-col items-center text-center">
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ ...smoothToonSpring, delay: 0.2 }}
              className="max-w-2xl mx-auto"
            >
              <div className="flex flex-wrap justify-center gap-4 mb-8">
                <Sticker color="#FACC15" rotate="-rotate-2">
                  Liquid Physics
                </Sticker>
                <Sticker color="#F472B6" rotate="rotate-3">
                  No Jitter
                </Sticker>
                <Sticker color="#60A5FA" rotate="-rotate-1">
                  Vector Sharp
                </Sticker>
              </div>

              <h1 className="text-6xl md:text-8xl font-black text-[#111] leading-[0.9] tracking-tight mb-6">
                LIQUID
                <br />
                TOON.
              </h1>

              <p className="text-xl font-bold text-[#111]/80 leading-relaxed mb-10 max-w-lg mx-auto">
                Geometry meets Motion. <br />
                Thick lines, hard shadows, and a heavy
                <span className="bg-yellow-200 px-1 border-b-2 border-black mx-1">
                  buttery spring
                </span>
                that feels like expensive rubber.
              </p>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-left">
                <div className="bg-white border-2 border-black hard-shadow-sm p-6 rounded-2xl">
                  <h3 className="font-black text-lg mb-2">
                    The "Butter" Spring
                  </h3>
                  <p className="font-bold text-sm text-gray-600">
                    Stiffness: 280, Damping: 24. Replaces the nervous vibration
                    of standard springs with a heavy, fluid thud.
                  </p>
                </div>
                <div className="bg-white border-2 border-black hard-shadow-sm p-6 rounded-2xl">
                  <h3 className="font-black text-lg mb-2">Stabilized Text</h3>
                  <p className="font-bold text-sm text-gray-600">
                    Labels use <code>layout="position"</code> to lock relative
                    coordinates during expansion, preventing sub-pixel shake.
                  </p>
                </div>
              </div>
            </motion.div>
          </main>
        );
      }

      /* 
       ================================================================
       4. INITIALIZATION
       ================================================================
    */
      function App() {
        return (
          <>
            <LiquidToonIsland />
            <PageContent />
          </>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
